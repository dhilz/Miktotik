# ===================================
# Mikrotik Bridge Mode + DHCP Server (Clean Setup)
# ether1 = uplink ke kantor (Fortinet)
# wlan1  = SSID Coretax
# Client dapat IP dari LAN Fortinet (DHCP off di Mikrotik)
# ===================================

# 1) Hapus bridge dan setingan lama
/interface bridge remove [find]
/ip address remove [find]
/ip route remove [find]
/ip dhcp-server remove [find]
/ip pool remove [find]
/interface wireless security-profiles remove [find]

# 2) Buat bridge baru
/interface bridge
add name=bridge1

/interface bridge port
add bridge=bridge1 interface=ether1
add bridge=bridge1 interface=wlan1

# 3) IP statis manajemen Mikrotik
/ip address
add address=10.12.55.200/24 interface=bridge1 comment="IP manajemen Mikrotik"

# 4) Default route ke gateway kantor
/ip route
add gateway=10.12.55.254

# 5) DNS kantor
/ip dns
set servers=10.254.28.30 allow-remote-requests=yes

# 6) Wireless SSID Coretax dengan password
/interface wireless security-profiles
add name=securewifi mode=dynamic-keys authentication-types=wpa2-psk wpa2-pre-shared-key="@Pajak123"

/interface wireless set [ find default-name=wlan1 ] \
    ssid="Coretax" mode=ap-bridge disabled=no security-profile=securewifi

# 7) DHCP server dimatikan (pakai DHCP Fortinet)
/ip dhcp-server disable [find]